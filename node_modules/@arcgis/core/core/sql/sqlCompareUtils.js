/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{SqlError as r,SqlErrorCodes as e}from"../../arcade/featureset/support/errorsupport.js";import{isDateTime as t,isTimestampOffset as n,isDateOnly as o,isTimeOnly as i,isNumber as a,isString as s}from"./sqlDateParsingUtils.js";import{SqlTimeStampOffset as u}from"./SqlTimestampOffset.js";import{isUnknownTimeZone as f,adoptTimeZone as c}from"./UnknownTimeZone.js";import{DateTime as l}from"luxon";function w(r){return!!t(r)||!!n(r)}function p(r){return!!t(r)||(!!o(r)||(!!n(r)||!!i(r)))}function m(i){if(t(i))return i.toMillis();if(o(i))return i.toNumber();if(n(i))return i.toMilliseconds();throw new r(e.InvalidDataType)}function d(d,N,x,b){if(null==d||null==N)return null;if(a(d)){if(a(N))return h(d,N,x);if(s(N))return O(d,N,x);if(p(N))throw new r(e.InvalidOperator);if(o(N))throw new r(e.InvalidOperator)}else if(s(d)){if(a(N))return v(d,N,x);if(s(N))return I(d,N,x);if(t(N))throw new r(e.InvalidOperator);if(o(N))throw new r(e.InvalidOperator);if(i(N))throw new r(e.InvalidOperator);if(n(N))throw new r(e.InvalidOperator)}else if(t(d)){if(w(N))return d instanceof l&&f(d.zone)?N instanceof l&&!1===f(N.zone)?d=c(d,N.zone):N instanceof u&&(d=c(d,N.toDateTime().zone)):N instanceof l&&f(N.zone)&&(d instanceof l&&!1===f(d.zone)?N=c(N,d.zone):d instanceof u&&(N=c(N,d.toDateTime().zone))),h(m(d),m(N),x);if(s(N))throw new r(e.InvalidOperator);if(o(N))return z(d,N,x);if(i(N))throw new r(e.InvalidOperator);if(a(N))throw new r(e.InvalidOperator)}else if(o(d)){if(n(N))return M(d,N,x);if(t(N))return T(d,N,x);if(s(N))throw new r(e.InvalidOperator);if(o(N))return h(d.toNumber(),N.toNumber(),x);if(i(N))throw new r(e.InvalidOperator);if(a(N))throw new r(e.InvalidOperator)}else if(i(d)){if(i(N))return h(d.toNumber(),N.toNumber(),x);if(s(N))throw new r(e.InvalidOperator);if(a(N))throw new r(e.InvalidOperator);if(o(N))throw new r(e.InvalidOperator);if(w(N))throw new r(e.InvalidOperator)}else if(n(d)){if(w(N))return N instanceof l&&f(N.zone)&&(N=c(N,d.toDateTime().zone)),h(m(d),m(N),x);if(s(N))throw new r(e.InvalidOperator);if(o(N))return D(d,N,x);if(i(N))throw new r(e.InvalidOperator);if(a(N))throw new r(e.InvalidOperator)}switch(x){case"<>":return d!==N;case"=":return d===N;case">":return d>N;case"<":return d<N;case">=":return d>=N;case"<=":return d<=N}}function h(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function O(r,e,t){const n=parseFloat(e);if(!isNaN(n))return h(r,n,t);const o=r.toString();switch(t){case"<>":return o!==e;case"=":return o===e;case">":return o>e;case"<":return o<e;case">=":return o>=e;case"<=":return o<=e}}function v(r,e,t){const n=parseFloat(r);if(!isNaN(n))return h(n,e,t);const o=e.toString();switch(t){case"<>":return r!==o;case"=":return r===o;case">":return r>o;case"<":return r<o;case">=":return r>=o;case"<=":return r<=o}}function I(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function z(r,e,t){const n=e.toDateTimeLuxon(r.zone);return h((r=r.startOf("day")).toMillis(),n.toMillis(),t)}function D(r,e,t){const n=e.toDateTimeLuxon(r.toDateTime().zone);return h((r=r.startOfDay()).toMilliseconds(),n.toMillis(),t)}function T(r,e,t){const n=r.toDateTimeLuxon(e.zone);return e=e.startOf("day"),h(n.toMillis(),e.toMillis(),t)}function M(r,e,t){const n=r.toDateTimeLuxon(e.toDateTime().zone);return e=e.startOfDay(),h(n.toMillis(),e.toMilliseconds(),t)}export{m as dateValueInMilliseconds,p as isDateOrTimeValue,w as isDateTimeComparableValue,d as sqlCompare};
